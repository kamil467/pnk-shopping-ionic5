{"version":3,"sources":["webpack:///src/app/pages/product-category/category.html","webpack:///src/app/pages/product-category/category-routing.module.ts","webpack:///src/app/pages/product-category/category.module.ts","webpack:///src/app/pages/product-category/category.scss","webpack:///src/app/pages/product-category/category.ts","webpack:///src/app/providers/product-category-provider.ts"],"names":["routes","path","component","CategoryRoutingModule","imports","forChild","exports","CategoryModule","declarations","entryComponents","CategoryListPage","categoryListProvider","alert","loadingController","basketProvider","shopProvider","platform","navCtrl","route","defaultHref","storeCode","snapshot","paramMap","get","backButton","subscribeWithPriority","console","log","productCatgeoryListObservable","getActiveProductCategoryListByShopCode","basketObjObservable","getActiveShopByStoreCode","pipe","s","initiateBasket","basket","totalItemsCount","items","forEach","item","quantity","getBasketForOrder","undefined","map","subscribe","data","pop","presentAlert","create","cssClass","header","subHeader","message","buttons","text","handler","present","selector","template","CategoryListProvider","http","angularFireCloudStore","shopCode","productCategoryListAPI","handleError","productCategoryRef","collection","SHOP_LIST_COLLECTION","doc","PRODUCT_CATEGORY","ref","where","snapshotChanges","finalData","propdCatObj","payload","id","err","error","ErrorEvent","status","providedIn"],"mappings":"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","file":"product-category-category-module-es5.js","sourcesContent":["export default \"<!--\\r\\n  Generated template for the ProductCategoryListPage page.\\r\\n\\r\\n  See http://ionicframework.com/docs/components/#navigation for more info on\\r\\n  Ionic pages and navigation.\\r\\n-->\\r\\n<ion-header>\\r\\n  <ion-toolbar color=\\\"crimson\\\">\\r\\n    <ion-buttons slot=\\\"start\\\">\\r\\n      <ion-button (click)=\\\"backButton()\\\"><ion-icon name=\\\"arrow-back\\\"></ion-icon></ion-button>\\r\\n    </ion-buttons>\\r\\n   <ion-title>\\r\\n      Product Category\\r\\n    </ion-title>\\r\\n  </ion-toolbar>\\r\\n</ion-header>\\r\\n\\r\\n<ion-content class=\\\"card-background-page\\\">\\r\\n   \\r\\n\\t<div *ngIf=\\\"basketObjObservable | async as myBasket; else loadingErrorTemplate\\\">\\r\\n\\t\\t<div *ngIf = \\\"myBasket.totalItemsCount != 0\\\">\\r\\n\\r\\n\\t\\t\\r\\n\\t\\t<ion-fab vertical=\\\"top\\\" horizontal=\\\"end\\\" slot=\\\"fixed\\\" >\\r\\n\\t\\t\\t<ion-fab-button   outline routerLink=\\\"/app/tabs/market/my-basket\\\">\\r\\n\\t\\t\\t\\t<ion-badge >{{myBasket.totalItemsCount}}</ion-badge>\\r\\n\\t\\t\\t\\t<ion-icon name=\\\"cart-sharp\\\"></ion-icon></ion-fab-button>\\r\\n\\t\\t  </ion-fab>\\r\\n\\t</div>\\r\\n</div>\\r\\n\\t<div *ngIf=\\\"productCatgeoryListObservable | async as catList ; else loadingErrorTemplate\\\">\\r\\n\\t<ion-grid>\\r\\n\\t\\t\\t<ion-row>\\r\\n\\t\\t\\t\\t<ion-col col-4 *ngFor=\\\"let category of catList\\\" size=\\\"4\\\">\\r\\n\\t\\t\\t\\t\\t<ng-container *ngIf=\\\"category != undefined; then pccard;\\\">\\r\\n\\t\\t\\t\\t\\t</ng-container>\\r\\n\\t\\t\\t\\t\\t<ng-template #pccard>\\r\\n\\t\\t\\t\\t\\t\\t<ion-card [routerLink]=\\\"['/app/tabs/market/product-list',category.id,category.storeCode]\\\">\\r\\n\\t\\t\\t\\t\\t\\t\\t<ng-container *ngIf=\\\"category.imageURL != null; then customImage;else defaultImage\\\">\\r\\n\\t\\t\\t\\t\\t\\t\\t</ng-container>\\r\\n\\t\\t\\t\\t\\t\\t\\t<ng-template #customImage>\\r\\n\\t\\t\\t\\t\\t\\t\\t\\t<img [src]=\\\"category.imageURL\\\" />\\r\\n              </ng-template>\\r\\n\\t\\t\\t\\t\\t\\t\\t\\t<ng-template #defaultImage>\\r\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t<img\\r\\n                  src=\\\"../../../assets/img/product_category.png\\\"\\r\\n                />\\r\\n              </ng-template>\\r\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t<ion-row class=\\\"cat-name\\\">\\r\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t<ion-col col-12 align-self-center text-center>\\r\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t<div>{{category.name}}</div>\\r\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t</ion-col>\\r\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t</ion-row>\\r\\n\\t\\t\\t\\t\\t\\t</ion-card>\\r\\n\\t\\t\\t\\t\\t</ng-template>\\r\\n\\t\\t\\t\\t</ion-col>\\r\\n\\t\\t\\t</ion-row>\\r\\n\\r\\n\\t</ion-grid>\\r\\n\\t</div>\\r\\n\\t<ng-template #loadingErrorTemplate>\\r\\n\\t\\t<div class=\\\"spin\\\"> <ion-spinner name=\\\"bubbles\\\"></ion-spinner>\\r\\n\\t\\t  </div>\\r\\n\\t\\t  \\r\\n\\t  </ng-template>\\r\\n</ion-content>\\r\\n<!--\\r\\n<ion-footer class=\\\"basket-footer\\\">\\r\\n\\t<ion-toolbar>\\r\\n   <app-footer-basket [basketFooterObj]=\\\"basketFooterObj\\\"></app-footer-basket>\\r\\n\\t</ion-toolbar>\\r\\n\\r\\n</ion-footer>  -->\";","import { NgModule } from '@angular/core';\r\nimport {RouterModule,  Routes } from '@angular/router';\r\nimport { CategoryListPage } from './category';\r\n\r\n\r\nconst routes:Routes=[\r\n  {\r\n  path:'',\r\n  component:CategoryListPage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [ RouterModule.forChild(routes)],\r\n  exports:[RouterModule],\r\n})\r\nexport class CategoryRoutingModule { }","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { IonicModule } from '@ionic/angular';\r\nimport { CategoryListPage } from './category';\r\nimport { CategoryRoutingModule } from './category-routing.module';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    CategoryRoutingModule\r\n  ],\r\n  declarations: [\r\n    CategoryListPage\r\n  ],\r\n  entryComponents: [\r\n    CategoryListPage\r\n  ]\r\n})\r\nexport class CategoryModule { }","export default \"ion-toolbar {\\n  color: white;\\n}\\n\\n.cat-name {\\n  background-color: crimson;\\n  font-weight: bold;\\n  color: white;\\n}\\n\\n.spin {\\n  position: fixed;\\n  left: 50%;\\n  top: 50%;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvcGFnZXMvcHJvZHVjdC1jYXRlZ29yeS9DOlxcSW9uaWNQcm9qZWN0XFxwbmstc2hvcHBpbmctaW9uaWM1L3NyY1xcYXBwXFxwYWdlc1xccHJvZHVjdC1jYXRlZ29yeVxcY2F0ZWdvcnkuc2NzcyIsInNyYy9hcHAvcGFnZXMvcHJvZHVjdC1jYXRlZ29yeS9jYXRlZ29yeS5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBRUksWUFBQTtBQ0FKOztBREVBO0VBQ0kseUJBQUE7RUFDQSxpQkFBQTtFQUNBLFlBQUE7QUNDSjs7QURDRTtFQUVFLGVBQUE7RUFDQSxTQUFBO0VBQ0EsUUFBQTtBQ0NKIiwiZmlsZSI6InNyYy9hcHAvcGFnZXMvcHJvZHVjdC1jYXRlZ29yeS9jYXRlZ29yeS5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiaW9uLXRvb2xiYXJcclxue1xyXG4gICAgY29sb3I6d2hpdGU7XHJcbn1cclxuLmNhdC1uYW1lIHtcclxuICAgIGJhY2tncm91bmQtY29sb3I6IGNyaW1zb247XHJcbiAgICBmb250LXdlaWdodDogYm9sZDtcclxuICAgIGNvbG9yOiB3aGl0ZTtcclxuICB9XHJcbiAgLnNwaW5cclxuICB7XHJcbiAgICBwb3NpdGlvbjpmaXhlZDtcclxuICAgIGxlZnQ6NTAlO1xyXG4gICAgdG9wOjUwJTtcclxuICB9IiwiaW9uLXRvb2xiYXIge1xuICBjb2xvcjogd2hpdGU7XG59XG5cbi5jYXQtbmFtZSB7XG4gIGJhY2tncm91bmQtY29sb3I6IGNyaW1zb247XG4gIGZvbnQtd2VpZ2h0OiBib2xkO1xuICBjb2xvcjogd2hpdGU7XG59XG5cbi5zcGluIHtcbiAgcG9zaXRpb246IGZpeGVkO1xuICBsZWZ0OiA1MCU7XG4gIHRvcDogNTAlO1xufSJdfQ== */\";","import { Component, OnInit } from \"@angular/core\";\r\nimport { ActivatedRoute } from \"@angular/router\";\r\nimport { AlertController, LoadingController,  NavController, Platform } from \"@ionic/angular\";\r\nimport { concat, from,  Observable, of, throwError } from \"rxjs\";\r\nimport { catchError, concatMap, delay, map } from \"rxjs/operators\";\r\nimport { BasketFooterObj, BasketObj } from \"../../interfaces/basket-interface\";\r\nimport { ProductCategory  } from \"../../interfaces/product-category\";\r\nimport { Shop, StoreServiceArea } from \"../../interfaces/shop-list\";\r\nimport { BasketProvider } from \"../../providers/basket-provider\";\r\nimport { CategoryListProvider } from \"../../providers/product-category-provider\";\r\nimport { ShopListProvider } from \"../../providers/shoplist-provider\";\r\nimport { BuildGridArray } from \"../../Utility/utility\";\r\n\r\n\r\n/**\r\n * Generated class for the ShoplistPage page.\r\n *\r\n * See https://ionicframework.com/docs/components/#navigation for more info on\r\n * Ionic pages and navigation.\r\n */\r\n\r\n@Component({\r\n  selector: \"page-categoryList\",\r\n  templateUrl: \"category.html\",\r\n    styleUrls: [\"category.scss\"]\r\n})\r\nexport class CategoryListPage implements OnInit {\r\n  productCatgeoryListObservable:Observable<ProductCategory[]>\r\n  basketObjObservable:Observable<BasketObj>;\r\n  defaultHref='';;\r\n\r\n  constructor(\r\n    public categoryListProvider: CategoryListProvider,public alert:AlertController,\r\n    public loadingController:LoadingController, public basketProvider: BasketProvider,\r\n    public shopProvider:ShopListProvider,public platform:Platform,public navCtrl: NavController,\r\n    private route: ActivatedRoute\r\n  ) {\r\n    const storeCode = this.route\r\n                    .snapshot\r\n                    .paramMap\r\n                    .get('storeCode'); //get the shopcode from params\r\n this.platform.backButton.subscribeWithPriority(10, () => {\r\n    console.log('Handler was called!');\r\n  });\r\n \r\n  }\r\n  \r\n ngOnInit(){\r\n  const storeCode = this.route\r\n                    .snapshot\r\n                    .paramMap\r\n                    .get('storeCode'); //get the shopcode from params\r\n\r\n   // load product category.\r\n    this.productCatgeoryListObservable =  this.categoryListProvider\r\n                                          .getActiveProductCategoryListByShopCode(storeCode)\r\n\r\n   // initiate the basket. (load shop data and then initaite basket)                                      \r\n   this.basketObjObservable = this.shopProvider\r\n   .getActiveShopByStoreCode(storeCode)\r\n   .pipe(\r\n    concatMap(\r\n      s => this.basketProvider.initiateBasket(s)\r\n           .pipe(map( basket => {\r\n            \r\n              let totalItemsCount =  0;\r\n            basket.items.forEach(item => \r\n              {\r\n               totalItemsCount = totalItemsCount+ item.quantity;\r\n              });\r\n              console.log(\"Count is :\"+totalItemsCount);\r\n            return ({...basket,totalItemsCount:totalItemsCount})\r\n \r\n           } ))\r\n    ));\r\n}\r\n\r\n  ionViewDidEnter() {\r\n      console.log(\"ViewDidEnter\");\r\n    this.defaultHref = `/app/tabs/market/shoplist`;\r\n\r\n    // refresh basket on everytime view loaded.\r\n   this.basketObjObservable = this.basketProvider\r\n                              .getBasketForOrder()\r\n                              .pipe(map( basket => {                                    \r\n                                let totalItemsCount =  0;\r\n                                       if(basket != undefined){\r\n                                basket.items.map(item => {\r\n                                  totalItemsCount = totalItemsCount+ item.quantity;\r\n                                })\r\n                              }\r\n  return ({...basket,totalItemsCount:totalItemsCount})\r\n  } ))\r\n  }\r\n\r\n   backButton()\r\n  {\r\n   console.log(\"back button clicked\");\r\n   this.basketProvider.getBasketForOrder()\r\n                              .pipe(map( basket => {                                    \r\n                                let totalItemsCount =  0;\r\n                                if(basket != undefined){\r\n                                  basket.items.map(item => {\r\n                                    totalItemsCount = totalItemsCount+ item.quantity;\r\n                                  })}\r\n  return ({...basket,totalItemsCount:totalItemsCount})\r\n  } )).subscribe(async data =>{\r\n    if(data.totalItemsCount == 0)\r\n    {\r\n      // navigate to page\r\n      console.log(\"allow to navigate\");\r\n      this.navCtrl.pop();\r\n    }\r\n    else{\r\n     await this.presentAlert();\r\n      console.log(\"Display popup\");\r\n    }\r\n  })\r\n\r\n\r\n  }\r\n  async presentAlert() {\r\n    const alert = await this.alert.create({\r\n      cssClass: 'my-custom-class',\r\n      header: 'Alert',\r\n      subHeader: 'Back to Market?',\r\n      message: 'you have items in your cart. Cart will be empty if you press Ok.',\r\n      buttons: [\r\n      {\r\n        text:'Ok',\r\n        handler:()=>{\r\n       // this.basketProvider.emptyBasket();  system automatically clear the basket.\r\n        this.navCtrl.pop();\r\n        }\r\n      },\r\n      {\r\n        text:'Cancel',\r\n        handler:()=>{\r\n          console.log(\"do nothing\");\r\n        }\r\n\r\n      }\r\n      \r\n      ]\r\n\r\n    });\r\n    await alert.present();\r\n  }\r\n}\r\n","import { HttpClient, HttpErrorResponse, HttpHeaders } from \"@angular/common/http\";\r\nimport { Injectable } from \"@angular/core\";\r\nimport { AngularFirestore, DocumentChangeAction } from \"@angular/fire/firestore\";\r\nimport { of, Observable,throwError  } from \"rxjs\";\r\nimport { catchError, first, retry, toArray } from 'rxjs/operators';\r\nimport { map } from \"rxjs/operators\";\r\nimport { environment } from '../../environments/environment'\r\nimport { ProductCategory } from \"../interfaces/product-category\";\r\n@Injectable({ providedIn: \"root\" })\r\nexport class CategoryListProvider {\r\n  \r\n  /* Data Initialization */\r\n  constructor(public http: HttpClient, private angularFireCloudStore: AngularFirestore) {}\r\n\r\n\r\ngetProductCategoryList(shopCode:string):Observable<ProductCategory[]>\r\n{\r\n  \r\nreturn this.http.get<ProductCategory[]>(environment.productCategoryListAPI)\r\n.pipe(\r\n  retry(3),\r\n  catchError(this.handleError)\r\n);\r\n}\r\n\r\n//Get active product catgeory for the given shopCode.\r\ngetActiveProductCategoryListByShopCode(shopCode:string):Observable<ProductCategory[]>\r\n{\r\n\r\nconst productCategoryRef = this.angularFireCloudStore\r\n                            .collection(environment.SHOP_LIST_COLLECTION)\r\n                            .doc(shopCode)\r\n                            .collection<ProductCategory>(environment.PRODUCT_CATEGORY, ref => ref.where(\"status\",\"==\",\"a\"))\r\n                            .snapshotChanges()\r\n                            .pipe(\r\n                              map(data =>{\r\n                                return data.map(finalData =>{\r\n                                    const propdCatObj = finalData.payload.doc.data() as ProductCategory\r\n                                    const id  = finalData.payload.doc.id\r\n\r\n                                    return {id, ...propdCatObj}\r\n                                }\r\n                                )\r\n                              }),\r\n                              catchError(err => this.handleError(err)));\r\n                            \r\n                            return productCategoryRef;\r\n\r\n}\r\n\r\n  private handleError(error: HttpErrorResponse) {\r\n  if (error.error instanceof ErrorEvent) {\r\n    // A client-side or network error occurred. Handle it accordingly.\r\n    console.error('An error occurred:', error.error.message);\r\n  } else {\r\n    // The backend returned an unsuccessful response code.\r\n    // The response body may contain clues as to what went wrong.\r\n    console.error(\r\n      `Backend returned code ${error.status}, ` +\r\n      `body was: ${error.error}`);\r\n\r\n      console.error(\"Detailed error is:\"+error);\r\n  }\r\n  // Return an observable with a user-facing error message.\r\n  return throwError(\r\n    'Something bad happened; please try again later.');\r\n}\r\n}\r\n"]}